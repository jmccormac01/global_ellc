"""
Code to generate LDCs using LDTK
"""
import numpy as np
import ldtk.filters as ldtkf
from ldtk import LDPSetCreator

# J234318.41
# Teff 6400, 50
# logg 4.40, 0.17
# z 0.27, 0.11

# J170217.77
# Teff = 6340, 140
# logg = 4.00, 0.15
# z = 0.22, 0.13

# WASP-115
# Teff = 6500, 100
# logg = 4.28, 0.10
# z = 0.02, 0.10

# WASP-149
# Teff = 5750 100
# logg = 4.3, 0.20
# z = 0.16, 0.11

# NGTS-10b
# Teff = 4400, 100
# logg =4.595, 0.019
# z = -0.02. 0.12

# setting up new filters
# NGTS
ngts = ldtkf.TabulatedFilter('ngts',
                            np.linspace(400, 1020, 32),
                            np.array([0.00, 0.00, 0.03, 0.06,
                                      0.03, 0.15, 66.71, 78.96,
                                      79.49, 79.61, 78.80, 77.63,
                                      77.09, 76.27, 75.20, 74.77,
                                      74.89, 73.68, 73.32, 71.53,
                                      71.02, 71.08, 69.81, 70.25,
                                      65.31, 0.05, 0.00, 0.00,
                                      0.00, 0.00, 0.00, 0.00]))
# Cousins I band - NITES
Ic = ldtkf.TabulatedFilter('Ic',
                           np.array([660.0, 680.0, 700.0, 720.0, 740.0,
                                     760.0, 780.0, 800.0, 820.0, 860.0,
                                     880.0, 900.0, 920.0, 940.0, 960.0,
                                     980.0, 1000.0, 1020.0, 1040.0,
                                     1060.0, 1080.0, 1100.0]),
                           np.array([0.000,0.000,
                                     0.001,0.236,0.745,0.909,
                                     0.935,0.939,0.927,0.907,
                                     0.892,0.874,0.852,0.824,
                                     0.787,0.737,0.671,0.587,
                                     0.485,0.375,0.265,0.170]))
# V johnson - NITES
Vj = ldtkf.TabulatedFilter('Vj',
                           np.array([420.0,440.0,460.0,480.0,500.0,
                                     520.0,540.0,560.0,580.0,600.0,
                                     620.0,640.0,660.0,680.0,700.0]),
                           np.array([0.000,0.000,0.000,
                                     0.012,0.809,0.895,0.821,
                                     0.639,0.385,0.159,0.041,
                                     0.006,0.001,0.000,0.000]))

Bj = ldtkf.TabulatedFilter('Bj',
                           np.array([320.000,340.000,360.000,380.000,
                                     400.000,420.000,440.000,460.000,
                                     480.000,500.000,520.000,540.000,
                                     560.000,580.000,600.000,620.000]),
                           np.array([0.000,0.000,0.011,0.459,
                                     0.718,0.784,0.776,0.700,
                                     0.452,0.196,0.049,0.011,
                                     0.022,0.004,0.000,0.000]))

# TODO add speculoos I+Z



if __name__ == "__main__":
    sc = LDPSetCreator(teff=(4400, 100),
                       logg=(4.595, 0.019),
                       z=(-0.02, 0.12),
                       filters=[ngts])
    ps = sc.create_profiles()
    cq, eq = ps.coeffs_qd(do_mc=True)
    print('LDC_1 {:.4f} {:.4f}'.format(cq[0][0], eq[0][0]))
    print('LDC_2 {:.4f} {:.4f}'.format(cq[0][1], eq[0][1]))

